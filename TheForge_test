-- ====================================================================
--                      Phoenix HUB | EXAMPLE                 
-- ====================================================================

local GAME = "Phoenix HUB | The Forge"
local VERSION = 1.2
local LATEST_UPDATE = "~"
local DISCORD_LINK = "dsc.gg/selena-hub"
local LOGO = "rbxassetid://140413750237602"
local CurrentIsland = ""

--[[<<===== DEPENDENCY CHECK & ISLAND CHECK =====]]

    -- Current Island Check
    if game.PlaceId == 76558904092080 then
        CurrentIsland = "Island 1"
        print("Fetching Script for place: Stonewake's Cross")
    elseif game.PlaceId == 129009554587176 then
        CurrentIsland = "Island 2"
        print("Fetching Script for place: Forgotten Kingdom")

    elseif game.PlaceId == 1233 then
        print("Fetching Script for place: Frostspire Expans")
    else
        game:GetService("StarterGui"):SetCore("SendNotification", { Title = "Unsupported game", Text = "This game is not supported by Phoenix HUB.", Duration = 5})
        return
    end
--

--[[<<===== TASK LOOP =====>>]]
    task.spawn(function()
        while true do
            -- Auto Mining
            if Configs["AutoMining"] then
                local success, err = pcall(function()
                    ReplicatedStorage.Shared.Packages.Knit.Services.ToolService.RF.ToolActivated:InvokeServer("Pickaxe")
                end)
                if not success then
                    warn("Auto Mining Error:", err)
                end
            end

            -- Auto Swing
            if Configs["AutoSwing"] then
                local success, err = pcall(function()
                    ReplicatedStorage.Shared.Packages.Knit.Services.ToolService.RF.ToolActivated:InvokeServer("Weapon", true)
                end)
                if not success then
                    warn("Auto Swing Error:", err)
                end
            end

            task.wait(0.5)
        end
    end)

--

--[[<<===== MAIN UI INITIALIZATION =====>>]]

    local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

    -- THEME
    WindUI:AddTheme({
        Name = "Default",
        Accent = Color3.fromHex("#ff7300"),
        Background = Color3.fromHex("#080808"),
        BackgroundTransparency = 0,
        Outline = Color3.fromHex("#ffffff"),
        Text = Color3.fromHex("#ffffff"),
        Placeholder = Color3.fromHex("#b8b8b8"),
        Button = Color3.fromHex("#ff7300"),

        Icon = Color3.fromHex("#ff7300"),
        WindowBackground = Color3.fromHex("#181818"), 
        WindowShadow = Color3.fromHex("#000000"),

        DialogBackground = Color3.fromHex("#1a1a1a"),
        DialogBackgroundTransparency = 0,
        DialogTitle = Color3.fromHex("#ffffff"),
        DialogContent = Color3.fromHex("#ffffff"),
        DialogIcon = Color3.fromHex("#ffa54d"),

        WindowTopbarButtonIcon = Color3.fromHex("#ff7300"),
        WindowTopbarTitle = Color3.fromHex("#ffffff"),
        WindowTopbarAuthor = Color3.fromHex("#ff7300"),
        WindowTopbarIcon = Color3.fromHex("#ffffff"),

        TabBackground = Color3.fromHex("#ff7300"),
        TabTitle = Color3.fromHex("#ffffff"),
        TabIcon = Color3.fromHex("#ff7300"),

        ElementTitle = Color3.fromHex("#ffffff"),
        ElementDesc = Color3.fromHex("#ffffff"),
        ElementIcon = Color3.fromHex("#ff7300"),
        PopupBackground = Color3.fromHex("#1a1a1a"),
        PopupBackgroundTransparency = 0,
        PopupTitle = Color3.fromHex("#ffffff"),
        PopupContent = Color3.fromHex("#ffffff"),
        PopupIcon = Color3.fromHex("#ff7300"),
        Toggle = Color3.fromHex("#ff7300"),
        ToggleBar = Color3.fromHex("#ffffff"),
        Checkbox = Color3.fromHex("#ff7300"),
        CheckboxIcon = Color3.fromHex("#ffffff"),
        Slider = Color3.fromHex("#ff7300"),
        SliderThumb = Color3.fromHex("#ffffff"),
    })

    WindUI:SetFont("rbxasset://fonts/families/Ubuntu.json")

    local Window = WindUI:CreateWindow({
        Title = GAME,
        Name = "PhoenixHUB_UI_Window",
        Author = "Version 1.3",
        Folder = "PhoenixHUB",
        NewElements = true,
        Size = UDim2.fromOffset(680, 430),
        MinSize = Vector2.new(560, 330),
        MaxSize = Vector2.new(680, 430),
        HideSearchBar = true,
        Transparent = false,
        Resizable = true,
        SideBarWidth = 150,
        Theme = "Default",
        Radius = 16,
        ElementsRadius = 10,
    })

    -- CONFIG 
    local ConfigManager = Window.ConfigManager
    ConfigManager:Init(Window)

    -- OPEN BUTTON
    Modules["OpenButton"].Create(Window)

    -- WINDOW SETTINGS
    Window:Tag({Title = "PREMIUM", Color = Color3.fromHex("#FFFF00"), Icon = "rbxassetid://11322089611"})
    Window:DisableTopbarButtons({"Close", "Minimize", "Fullscreen",})

    -- TOPBAR BUTTONS
    Window:CreateTopbarButton("", "x",    function() 
        Window:Dialog({ Icon = "rbxassetid://14446997892", Title = "Close Confirmation", Content = "Are you sure you want to close gui?",
            Buttons = {
                {
                    Title = "Close Window",
                    Variant = "Primary",
                    Callback = function()
                        Window:Destroy()
                        Modules.OpenButton.Destroy()
                    end,
                },
                {
                    Title = "Cancel",
                    Variant = "Secondary",
                    Callback = function()
                    end,
                },
            },
        })
    end,  990)

    Window:CreateTopbarButton("", "minus",    function() 
        Window:Toggle()
    end,  989)
    

--

-- >> ðŸ“Œ INFORMATION TAB << 
    local InfoTab = Window:Tab({Title = "Information", Icon = "circle-alert"})
    InfoTab:Select()

    -- PLAYER INFO SECTION
    InfoTab:Section({Title = "Player Information"})
    local PlayerInfo = InfoTab:Paragraph({
        Title = "Welcome "..Player.Name.."!",
        Image = GetProfilePic(),
    })

    -- DISCORD SECTION
    InfoTab:Section({Title = "Join Discord Server Phoenix HUB"})
    InfoTab:Paragraph({
        Title = "Phoenix HUB Community",
        Desc = "Be part of our Community Discordâ€”get new announcements, access support, and chat with other users!",
        Image = LOGO,        
        Buttons = {
            {
                Icon = "link",
                Title = "Copy Discord Link",
                Callback = function() setclipboard(DISCORD_LINK); Notify("Discord Link", "Link copied to clipboard!", "link") end,                
            }
        }
    })

    -- [[ Update Player Data ]]
    local function UpdatePlayerInfo()
        if not PlayerInfo then return end

        PlayerInfo:SetDesc((
            'â€¢ Gold: <font color="#ffcc00">%s</font><br/>' ..
            'â€¢ Level: <font color="#ffcc00">%s</font><br/>' ..
            'â€¢ Stash: <font color="#ffcc00">%s</font><br/>' ..
            'â€¢ Status: <font color="#ffcc00">%s</font>'
        ):format(
            PlayerData["Gold"],
            PlayerData["Level"],
            PlayerData["Stash"],
            PlayerData["Status"]
        ))
    end

    -- Pantau perubahan Gold
    PlayerGui.Main.Screen.Hud.Gold:GetPropertyChangedSignal("Text"):Connect(function()
        PlayerData["Gold"] = PlayerGui.Main.Screen.Hud.Gold.Text
        UpdatePlayerInfo()
    end)

    -- Pantau perubahan Level
    Player:GetAttributeChangedSignal("Level"):Connect(function()
        PlayerData["Level"] = Player:GetAttribute("Level") or 0
        UpdatePlayerInfo()
    end)

    -- Pantau perubahan Stash
    PlayerGui.Menu.Frame.Frame.Menus.Stash.Capacity.Text:GetPropertyChangedSignal("Text"):Connect(function()
        PlayerData["Stash"] = PlayerGui.Menu.Frame.Frame.Menus.Stash.Capacity.Text.Text:match(":%s*(.*)") or "0/0"
        UpdatePlayerInfo()
    end)

    -- Inisialisasi tampilan pertama kali
    UpdatePlayerInfo()



--

-- >> ðŸ“Œ SETTINGS TAB << 
    local SettingsTab = Window:Tab({Title = "Settings", Icon = "settings"})
    -- Game Settings
    SettingsTab:Section({Title = "Game Settigs"})
    SettingsTab:Toggle({
        Flag = "DisableAllObject",
        Title = "Disable All Object",
        Callback = function(state)
            HideAllObject(state)

            --==[[ Toggle Notification ]]==--
            if state then
                Notify("Enable", "Disable All Object has been enabled")
            else
                Notify("Disable", "Disable All Object has been disabled")
            end
        end
        
    })
    SettingsTab:Space()

    SettingsTab:Toggle({
        Flag = "Hide3dRendering",
        Title = "Disable 3D Rendering",
        Callback = function(state)
            Disable3dRendering(state)
            --==[[ Toggle Notification ]]==--
            if state then
                Notify("Enable", "Disable 3D Rendering has been enabled")
            else
                Notify("Disable", "Disable 3D Rendering has been disabled")
            end            
        end
        
    })


    -- Save Manager
    SettingsTab:Section({Title = "Save Manager"})

    local configInput = SettingsTab:Input({
        Title = "Config Name",
        Value = configName,
        Callback = function(value)
            configName = value or "default"
        end
    })

    SettingsTab:Dropdown({
        Title = "Select Config",
        Values = ConfigManager:AllConfigs(),
        Value = Configs["SaveName"],
        AllowNone = false,
        Callback = function(value)
            Configs["SaveName"] = value or "default"
            configInput:Set(Configs["SaveName"])
        end
    })

    SettingsTab:Button({
        Title = "SAVE CONFIG",
        Icon = "save",
        IconAlign = "Left",
        Justify = "Center",
        Callback = function()
            Configs["ConfigFile"] = ConfigManager:CreateConfig(Configs["SaveName"])
            Configs["ConfigFile"]:Set("playerData", MyPlayerData)
            Configs["ConfigFile"]:Set("lastSave", os.date("%Y-%m-%d %H:%M:%S"))
            
            if Configs["ConfigFile"]:Save() then
                WindUI:Notify({ 
                    Title = "SAVE CONFIG", 
                    Content = "Saved as: "..Configs["SaveName"],
                    Icon = "check",
                    Duration = 3
                })
            else
                WindUI:Notify({ 
                    Title = "Error", 
                    Content = "Failed to save config",
                    Icon = "x",
                    Duration = 3
                })
            end
        end
    })

    SettingsTab:Button({
        Title = "LOAD CONFIG",
        IconAlign = "Left",
        Justify = "Center",
        Icon = "folder",
        Callback = function()
            Configs["ConfigFile"] = ConfigManager:CreateConfig(Configs["SaveName"])
            local loadedData = Configs["ConfigFile"]:Load()
            
            if loadedData then
                if loadedData.playerData then
                    MyPlayerData = loadedData.playerData
                end
                
                local lastSave = loadedData.lastSave or "Unknown"
                WindUI:Notify({ 
                    Title = "LOAD CONFIG", 
                    Content = "Loaded: "..Configs["SaveName"].."\nLast save: "..lastSave,
                    Icon = "refresh-cw",
                    Duration = 5
                })
            else
                WindUI:Notify({ 
                    Title = "Error", 
                    Content = "Failed to load config",
                    Icon = "x",
                    Duration = 3
                })
            end
        end
    })
--


--[[<<===== END =====>>]]
    -- ON DESTROY
    Window:OnDestroy(function()
        for _, v in ipairs(PlayerGui:GetChildren()) do
            if v.Name == "PhoenixHUB" then
                v:Destroy()
            end
        end
    end)

    -- ON CLOSE
    Window:OnClose(function()
        if ConfigManager and Configs["ConfigFile"] then
            Configs["ConfigFile"]:Set("playerData", MyPlayerData)
            Configs["ConfigFile"]:Set("lastSave", os.date("%Y-%m-%d %H:%M:%S"))
            Configs["ConfigFile"]:Save()
            Notify("Auto-Save", "Your configuration has been auto-saved.", "save")
        end
    end)

    Notify("Phoenix HUB", "Phoenix HUB loaded successfully!", LOGO)
--